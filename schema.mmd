erDiagram
    Account {
        ObjectId _id
        ISODate expiredAt
        ISODate createdAt
    }
    %% @validation Account
    %% _id: { type: ObjectId, required: true }
    %% expiredAt: { type: ISODate, required: false }
    %% createdAt: { type: ISODate, required: true }

    User {
        ObjectId _id
        ObjectId accountId
        String username
        String password
        String name
        Boolean isAccountOwner
        ISODate createdAt
        ISODate updatedAt
    }
    %% @validation User
    %% _id: { type: ObjectId, required: true }
    %% accountId: { type: ObjectId, required: true }
    %% username: { type: String, required: true, minLength: 3, maxLength: 50 }
    %% password: { type: String, required: true, minLength: 8 }
    %% name: { type: String, required: false, maxLength: 100 }
    %% isAccountOwner: { type: Boolean, required: true }
    %% createdAt: { type: ISODate, required: true }
    %% updatedAt: { type: ISODate, required: true }

    Profile {
        ObjectId _id
        ObjectId userId
        String name
        JSON preferences
        Integer radiusMiles
        ISODate createdAt
        ISODate updatedAt
    }
    %% @validation Profile
    %% _id: { type: ObjectId, required: true }
    %% userId: { type: ObjectId, required: true }
    %% name: { type: String, required: true, maxLength: 100 }
    %% preferences: { type: JSON, required: false }
    %% radiusMiles: { type: Integer, required: false, min: 0 }
    %% createdAt: { type: ISODate, required: true }
    %% updatedAt: { type: ISODate, required: true }

    TagAffinity {
        ObjectId _id
        ObjectId profileId
        String tag
        Integer affinity
        ISODate updatedAt
    }
    %% @validation TagAffinity
    %% _id: { type: ObjectId, required: true }
    %% profileId: { type: ObjectId, required: true }
    %% tag: { type: String, required: true, maxLength: 50 }
    %% affinity: { type: Integer, required: true, min: -100, max: 100 }
    %% updatedAt: { type: ISODate, required: true }

    Event {
        ObjectId _id
        String url
        String title
        ISODate dateTime
        String location
        Number cost
        Integer numOfExpectedAttendees
        String recurrence
        Array[String] tags
        ISODate updatedAt
    }
    %% @validation Event
    %% _id: { type: ObjectId, required: true }
    %% url: { type: String, required: true, pattern: ^https?://[^\s]+$ }
    %% title: { type: String, required: true, maxLength: 200 }
    %% dateTime: { type: ISODate, required: true }
    %% location: { type: String, required: false, maxLength: 200 }
    %% cost: { type: Number, required: false, min: 0 }
    %% numOfExpectedAttendees: { type: Integer, required: false, min: 0 }
    %% recurrence: { type: String, required: false, enum: [daily, weekly, monthly, yearly] }
    %% tags: { type: Array[String], required: false }
    %% updatedAt: { type: ISODate, required: true }

    UserEvent {
        ObjectId _id
        ObjectId userId
        ObjectId eventId
        Boolean attended
        Integer rating
        String note
        ISODate updatedAt
    }
    %% @validation UserEvent
    %% _id: { type: ObjectId, required: true }
    %% userId: { type: ObjectId, required: true }
    %% eventId: { type: ObjectId, required: true }
    %% attended: { type: Boolean, required: false }
    %% rating: { type: Integer, required: false, min: 1, max: 5 }
    %% note: { type: String, required: false, maxLength: 500 }
    %% updatedAt: { type: ISODate, required: true }

    Url {
        ObjectId _id
        String url
        JSON params
        ISODate updatedAt
    }
    %% @validation Url
    %% _id: { type: ObjectId, required: true }
    %% url: { type: String, required: true, pattern: ^https?://[^\s]+$ }
    %% params: { type: JSON, required: false }
    %% updatedAt: { type: ISODate, required: true }

    Crawl {
        ObjectId _id
        ObjectId url_id
        ISODate last_parsed_date
        JSON parse_status
        Array[String] errors_encountered
        ISODate updatedAt
    }
    %% @validation Crawl
    %% _id: { type: ObjectId, required: true }
    %% url_id: { type: ObjectId, required: true }
    %% last_parsed_date: { type: ISODate, required: false }
    %% parse_status: { type: JSON, required: false }
    %% errors_encountered: { type: Array[String], required: false }
    %% updatedAt: { type: ISODate, required: true }

    Account ||--o{ User: ""
    User ||--o{ Profile: ""
    Profile ||--o{ TagAffinity: ""
    User ||--o{ UserEvent: ""
    Event ||--o{ UserEvent: ""
    Url ||--o{ Crawl: ""
